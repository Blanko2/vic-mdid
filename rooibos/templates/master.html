{% load ui %}
{% load help %}
{% load analytics %}
{% load humanize %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>{% block title %}MDID 3 {% block titledetail %}{% endblock %}{% endblock %}</title>
{% block stylesheets %}
    <link href="/static/jquery/jquery-ui-themeroller.css" rel="stylesheet" type="text/css" media="screen">
    <link href="/static/css/master.css" rel="stylesheet" type="text/css" media="screen">
<!--[if IE]>
    <link href="/static/css/master-ie.css" rel="stylesheet" type="text/css" media="screen">
<![endif]-->
{% endblock %}
{% block javascript %}
    <script type="text/javascript" src="/static/jquery/jquery-1.3.2.min.js"></script>
    <script type="text/javascript" src="/static/jquery/jquery-ui-1.7.2.custom.min.js"></script>
    <script type="text/javascript" src="/static/jquery/jquery.cookie.js"></script>
    <script type="text/javascript" src="/static/jquery/jquery.hoverIntent.minified.js"></script>
    <script type="text/javascript" src="/static/jquery/jquery.ajaxmanager.js"></script>
    <script type="text/javascript">
        var ajaxManager = $.manageAjax.create('cacheQueue', { queue: true });
    </script>    
    <script type="text/javascript" src="/static/scripts/selected-records.js"></script>
    <script type="text/javascript" src="/static/scripts/related-images-bar.js"></script>
    <script type="text/javascript" src="/static/scripts/ui-scripts.js"></script>
    <!--<script type="text/javascript" src="/jsi18n/"></script>-->        
    <script type="text/javascript">
        $(document).ready(function() {
            
            var hidemainmenutimeout;
            function hide_main_menu() {
                hidemainmenutimeout = setTimeout('$("#main-menu").hide();', 500);
            }
            function show_main_menu() {
                clearTimeout(hidemainmenutimeout);
                $("#main-menu").show();
            }
            
            
            $("#main-menu-anchor, #main-menu").hover(show_main_menu, hide_main_menu);
            
/*            $("#menu .dropdown").css({
                'overflow': 'visible',
                'display': 'none',
                'top': '1.8em',
                'padding-top': '0px'
            });
            $(".hover-menu").hoverIntent({
                sensitivity: 1,
                interval: 50,
                over: function() { $(this).children(".dropdown").slideDown(); },
                timeout: 500,
                out: function() { $(this).children(".dropdown").slideUp(); },
            });            */
            updateSelectedRecords();
            
            $("#quicksearchkw").hint();
            $("#quicksearchlabel").hide();
        });
    </script>
{% endblock %}
</head>

<body class="ui-reset">
{% block header %}
<div id="header">
    <div id="main-menu-anchor"><h1><a href="/">MDID 3</a></h1></div>    
    <div id="main-menu">
        <span>My Content</span>
        {% if user.is_authenticated %}        
        <a href="{% url presentation-manage %}">My Presentations</a>
        <a href=".">My Favorites</a>
        <a href="{% url solr-search %}?c=owner:{{ user.id }}">My Content</a>
        <a href=".">Options</a>
        {% else %}
        <a href="{% url login %}">Log in</a>
        {% endif %}
        <span>Find Content</span>
        <a href="{% url solr-search %}">Explore</a>
        <a href="{% url solr-searchform %}">Search</a>
        <a href="{% url solr-browse %}">Browse</a>
        <a href="{% url solr-overview %}">Collection Overview</a>
        <a href=".">Presentations</a>
        <a href="{% url flickr-main %}">Flickr</a>
        <a href="{% url about %}">About</a>
    </div>
    <ul id="menu">
        {% if user.is_authenticated %}
            <li><span class="nolink">Welcome, {{ user.first_name }}</span></li>
            {% if user.is_staff %}
                <li><a href="{% url admin "" %}">Administration</a></li>
            {% endif %}
        {% else %}
            <li><a href="{% url login %}">Log in</a></li>
        {% endif %}
        {% with request.session.selected_records|length as selected %}
            <li><a href="{% url data-selected %}">{{ selected|intcomma }} record{{ selected|pluralize }} selected</a>
        {% endwith %}
        {% if user.is_authenticated %}
        <li><a href="{% url logout %}">Log out</a></li>
        {% endif %}
        <li>{% block help %}{% pagehelp 'main' %}{% endblock %}</li>
    </ul>    
    <form method="GET" action="{% url solr-search %}" id="quicksearch">
        <label id="quicksearchlabel" for="quicksearchkw">Quick search:</label>
        <input type="text" name="kw" id="quicksearchkw" title="Quick search" />
    </form>
</div>
{% if messages %}
<div id="messages">
<ul>
    {% for message in messages %}
    <li>{{ message }}</li>
    {% endfor %}
</ul>
</div>
{% endif %}

{% endblock %}

{% block raw-content %}
<div id="content">
{% block content %}
{% endblock %}
</div>
{% endblock %}

{% block footer %}
<div id="footer">
    Copyright 1997-2009 James Madison University
</div>
{% endblock %}

<div style="display: none;">    
    <div id="selected-records" class="menu">
        <div><input type="button" id="selected-records-deselect-all" value="Deselect all records" /></div>
        <div><input type="button" id="selected-records-export-flickr" value="Export to Flickr" /></div>
    </div>
</div>

<div id="related-images-bar" style="display: none;">
    <div id="related-images-bar-toggle">
        <div id="related-images-bar-hide" style="float: right;"></div>
        <span id="related-images-bar-hint"></span>
        <span id="related-images-bar-all" style="margin-left: 20px; "></span>
    </div>
    <div id="related-images-bar-content"></div>
</div>
<div id="related-images-bar-placeholder" style="visibility: hidden;"></div>

{% analytics %}

{% if debug %}<!--
{{ sql_queries|length }} queries:
{% for q in sql_queries %}
{{ q.sql }} ({{ q.time }})
{% endfor %}
-->
<div id="stats"><!-- STATS: Total: %(totTime).2fs <br/>Python: %(pyTime).2fs <br/>DB: %(dbTime).2fs <br/>Queries: %(queries)d --></div>
{% endif %}
</body>

</html>
