{% load ui %}
{% load help %}
{% load analytics %}
{% load humanize %}
<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<head>
    <title>{% block title %}MDID 3 {% block titledetail %}{% endblock %}{% endblock %}</title>
{% block stylesheets %}
    <link href="{% url static 'jquery/jquery-ui-themeroller.css' %}" rel="stylesheet" type="text/css" media="screen">
    <link href="{% url static 'css/reset.css' %}" rel="stylesheet" type="text/css" media="screen" />
    <link href="{% url static 'css/master.css' %}" rel="stylesheet" type="text/css" media="screen">
    <link href="{% url static 'css/typography.css' %}" rel="stylesheet" type="text/css" media="screen" />
    <link href="{% url static 'css/layout.css' %}" rel="stylesheet" type="text/css" media="screen" />
<!--[if IE]>
    <link href="{% url static 'css/master-ie.css' %}" rel="stylesheet" type="text/css" media="screen">
<![endif]-->
{% endblock %}
{% block javascript %}
    <script type="text/javascript" src="{% url static 'jquery/jquery-1.3.2.min.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery-ui-1.7.2.custom.min.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.cookie.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.hoverIntent.minified.js' %}"></script>
    <script type="text/javascript" src="{% url static 'jquery/jquery.ajaxmanager.js' %}"></script>
    <script type="text/javascript">
        var ajaxManager = $.manageAjax.create('cacheQueue', { queue: true });
    </script>
    <script type="text/javascript" src="{% url static 'scripts/related-images-bar.js' %}"></script>
    <script type="text/javascript" src="{% url static 'scripts/ui-scripts.js' %}"></script>
    <!--<script type="text/javascript" src="/jsi18n/"></script>-->
    <script type="text/javascript">
        function recordSelection(ids, checked) {
            var method = ids == 0 ? 'GET' : 'POST';
            if (!ids.length) ids = [ids];
            ajaxManager.add({
                type: method,
                url: '/ui/api/select-record/',
                data: {'id': ids, 'checked': checked},
                dataType: 'json',
                success: function(r) { $("#session-status").html(r.status); }
            });
        }

        function bindSelectRecordCheckboxes() {
            $(".record-select").click(function() { recordSelection($(this).attr('value'), $(this).attr('checked')); });
        }

        $(document).ready(function() {
            bindSelectRecordCheckboxes();
            var hidemainmenutimeout;
            $("#main-menu-anchor, #main-menu").hover(
                function() { clearTimeout(hidemainmenutimeout); $("#main-menu").show(); },
                function() { hidemainmenutimeout = setTimeout('$("#main-menu").hide();', 500); }
            );
            $("#quicksearchkw").hint();
            $("#quicksearchlabel").hide();
            recordSelection(0, false);

            var menu_timeout;
            function menu(id) {
                clearTimeout(menu_timeout);
                $("#discover_menu, #organize_menu, #experience_menu").hide();
                $(id).show();
            }
            $(".primary_navigation").show();
            $("#organize_menu, #experience_menu").hide();
            $("#discover_menu, #organize_menu, #experience_menu").css("margin-left", "163px");
            $("#organize_menu li:first, #experience_menu li:first").addClass("first");
            $("#discover_title").mouseover(function() { menu("#discover_menu"); });
            $("#organize_title").mouseover(function() { menu("#organize_menu"); });
            $("#experience_title").mouseover(function() { menu("#experience_menu"); });
            $("#navigation_bar").mouseover(function() { clearTimeout(menu_timeout); })
                .mouseleave(function() { menu_timeout = setTimeout(function() { menu("#discover_menu"); }, 1000); });
        });
    </script>
{% endblock %}
</head>

<body class="ui-reset">
{% block header %}

<div id="banner">
    <a href="{% url main %}" id="logo">MDID 3</a>
    <div id="search">
        {% if user.is_authenticated %}
        <span>Welcome{% if user.first_name %}, {{ user.first_name }}{% endif %}</span>
        | <a href="{% url logout %}">Log out</a>
        | <a href=".">Options</a>
            {% if user.is_staff %}
                | <a href="{% url admin "" %}">Administration</a>
            {% endif %}
        {% else %}
        <a href="{% url login %}?next={{ request.get_full_path }}">Log in</a>
        {% endif %}
        | {% block help %}{% pagehelp 'main' %}{% endblock %}<br />
        <form method="GET" action="{% url solr-search %}" id="quicksearch">
            <label id="quicksearchlabel" for="quicksearchkw">Quick search:</label>
            <input type="text" name="kw" id="quicksearchkw" title="Quick search" />
            <input name="search-button" type="image" id="search-button" src="{% url static 'images/search-button.gif' %}" alt="Search">
        </form>
    </div>

    <div class="navigation primary_navigation" style="display: none;">
    <ul>
        <li class="first"><a id="discover_title" href="#">Discover</a></li>
        {% if user.is_authenticated %}
        <li><a id="organize_title" href="#">Organize</a></li>
        {% endif %}
        <li class="last"><a id="experience_title" href="#">Experience</a></li>
    </ul>
    </div>

</div>


<div class="navigation secondary_navigation" id="navigation_bar">
    <ul id="discover_menu">
        <li class="first"><a href="{% url solr-search %}">Explore</a></li>
        <li><a href="{% url solr-searchform %}">Search</a></li>
        <li><a href="{% url solr-browse %}">Browse</a></li>
<!--        <li><a href="#">Tags</a></li>-->
        <li><a href="{% url solr-overview %}">Overview</a></li>
    </ul>
    {% if user.is_authenticated %}
    <ul id="organize_menu">
        <li><a href="{% url presentation-manage %}">Presentations</a></li>
        <li><a href="{% url solr-search %}?c=ownedtag:{{ user.id }}-favorite">Favorites</a></li>
        <li><a href="{% url solr-search %}?c=owner:{{ user.id }}">Content</a></li>
    </ul>
    {% endif %}
    <ul id="experience_menu">
        <li><a href="#">Browse Presentations</a></li>
        <li><a href="{% url showcases %}">Showcases</a></li>
        <li><a href="{% url about %}">About</a></li>
    </ul>
    <ul>
    {% with request.session.selected_records|length as selected %}
        <li><a href="{% url data-selected %}" id="session-status">{{ selected|intcomma }} record{{ selected|pluralize }} selected</a></li>
    {% endwith %}
    </ul>
</div>


{% if messages %}
<div id="messages">
<ul>
    {% for message in messages %}
    <li>{{ message }}</li>
    {% endfor %}
</ul>
</div>
{% endif %}

{% endblock %}

{% block raw-content %}
<div id="content">
{% block content %}
{% endblock %}
</div>
{% endblock %}

{% block footer %}
<div id="footer">
    Copyright 1997-2009 James Madison University
</div>
{% endblock %}

<div style="display: none;">
    <div id="selected-records" class="menu">
        <div><input type="button" id="selected-records-deselect-all" value="Deselect all records" /></div>
        <div><input type="button" id="selected-records-export-flickr" value="Export to Flickr" /></div>
    </div>
</div>

<div id="related-images-bar" style="display: none;">
    <div id="related-images-bar-toggle">
        <div id="related-images-bar-hide" style="float: right;"></div>
        <span id="related-images-bar-hint"></span>
        <span id="related-images-bar-all" style="margin-left: 20px; "></span>
    </div>
    <div id="related-images-bar-content"></div>
</div>
<div id="related-images-bar-placeholder" style="visibility: hidden;"></div>

{% analytics %}

{% if debug %}<!--
{{ sql_queries|length }} queries:
{% for q in sql_queries %}
{{ q.sql }} ({{ q.time }})
{% endfor %}
-->
<div id="stats"><!-- STATS: Total: %(totTime).2fs <br/>Python: %(pyTime).2fs <br/>DB: %(dbTime).2fs <br/>Queries: %(queries)d --></div>
{% endif %}
</body>

</html>
