{% extends "data_record_master.html" %}
{% load ui %}
{% load viewers %}

{% block record_content %}

<div>
{% if fieldvalues %}
    <h2>Main Metadata</h2>
    
    <form method="POST" action="">
    <div>
    {% for value in fieldvalues %}
        <div>
            <input type="checkbox" name="override" value="{{ value.id }}" />
            <span>{{ value.resolved_label }}:</span> <span>{{ value.value|safe }}</span>
        </div>
    {% endfor %}
        <input type="submit" name="override_values" value="Override selected values" />
    </div>
    </form>
    
    <h2>Custom Metadata</h2>
{% else %}
    <h2>Edit Metadata</h2>
{% endif %}
    
    <form method="POST" action="">
        {{ fv_formset.management_form }}
        <div>
        {% for form in fv_formset.forms %}        
            <div class="fieldvalue-edit{% cycle '' ' alternate-row' %}">
                {{ form.errors }}{{ form.id }}
                <div class="column">
                    <span class="row"><label for="{{ form.field.html_name }}">Field:</label> {{ form.field }}</span>
                    <span class="row"><label for="{{ form.label.html_name }}">Label:</label> {{ form.label }}</span>
                </div>
                <div class="column">
                    <span class="row">{{ form.value }}</span>
                </div>
                <div class="column">
                    <span class="row"><label for="{{ form.type.html_name }}">Type:</label> {{ form.type }}</span>
                    <span class="row"><label for="{{ form.language.html_name }}">Language:</label> {{ form.language }}</span>
                    <span class="row"><label for="{{ form.ORDER.html_name }}">Order:</label> <span class="fs-order">{{ form.ORDER }}</span></span>
                </div>
                <div class="column">
                    <span class="row"><label for="{{ form.hidden.html_name }}">Hide:</label> {{ form.hidden }}</span>                    
                    <span class="row"><label for="{{ form.DELETE.html_name }}">Delete:</label> {{ form.DELETE }}</span>
                    {% if form.is_overriding %}<span class="row">This value overrides another value.</span>{% endif %}
                </div>
            </div>
        {% endfor %}        
            <input type="submit" value="Submit Changes" />
        </div>
    </form>
</div>

{% endblock %}