{% extends "master.html" %}
{% load ui %}
{% load viewers %}

{% block titledetail %}
- {{ record.title }}
{% endblock %}

{% block extrajavascript %}
{{ block.super }}
<script type="text/javascript">
$(document).ready(function() {
    $("#metadata-form select").change(function () { this.form.submit(); });
    $("#metadata-form :submit").remove();
});
</script>
{% endblock %}

{% block content %}

<div class="sidebar">

<div class="sidebar-item">
    <img src="{{ record.get_thumbnail_url|default:"/static/images/nothumbnail.png" }}" alt="{{ record.title }}" />
</div>

{% if record.parent %}
<div class="sidebar-item">
    <h2>Parent record</h2>
    {% record record.parent 'selectable' %}
    <br style="clear: both" />
</div>
{% endif %}

{% if record.record_set.count %}
<div class="sidebar-item">
    <h2>Child records</h2>
    <div style="max-height: 400px; overflow: auto; ">
        {% for child in record.record_set.all %}
            {% record child 'selectable' %}
        {% endfor %}
        <br style="clear: both" />
    </div>
</div>
{% endif %}

{% if media %}
<div>
    <h2>Media</h2>
    <ul>
    {% for m in media %}
        <li>
            <a href="{{ m.get_absolute_url }}">{{ m.name }}</a>
            {{ m.mimetype }}
            {% if m.width and m.height %}
                {{ m.width }}x{{ m.height }}
            {% endif %}
        </li>    
    {% endfor %}
    </ul>
</div>
{% endif %}

</div>




<div>


<h1>{{ record.title }}</h1>




    <h2>Available Metadata</h2>
    
    <form id="metadata-form" action="." method="GET">
    Display metadata as: <select name="fieldset">
    <option value="_all"{% ifequal selected_fieldset "_all" %} selected="selected"{% endifequal %}>Show All</option>
    <option value=""{% if not selected_fieldset %} selected="selected"{% endif %}>Default</option>
    {% for fieldset in fieldsets %}
    <option value="{{ fieldset.name }}"{% ifequal selected_fieldset fieldset.name %} selected="selected"{% endifequal %}>{{ fieldset.title }}</option>
    {% endfor %}
    </select>
    <input type="submit" value="Change" />
    </form>
    
    <div>
    {% for value in fieldvalues %}
        <span>{{ value.resolved_label }}:</span> <span>{{ value.value }}</span><br />
    {% endfor %}
    </div>
</div>



{% endblock %}